 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/INSTALAR_CARRITO.bat b/INSTALAR_CARRITO.bat
index 8b7c1e8b3a6df53b976c082f8f9b41fc2d21f63e..5580e778cbe4c1faf3bf3898d55d657708751968 100644
--- a/INSTALAR_CARRITO.bat
+++ b/INSTALAR_CARRITO.bat
@@ -1,51 +1,81 @@
 @echo off
+setlocal EnableDelayedExpansion
 cls
 echo ==========================================
 echo   INSTALADOR DE TABLAS DE ORDENES
 echo   Base de datos: smartshop
 echo ==========================================
 echo.
 
-set MYSQL_BIN=C:\laragon\bin\mysql\mysql-8.0.30-winx64\bin
-set DB_NAME=smartshop
+set "DB_NAME=smartshop"
+set "MYSQL_EXE="
 
-echo [1/3] Verificando MySQL...
-if not exist "%MYSQL_BIN%\mysql.exe" (
-    echo ERROR: No se encontro MySQL en la ruta esperada
-    echo Ruta buscada: %MYSQL_BIN%
+REM Permitir que el usuario defina MYSQL_PATH antes de ejecutar
+if defined MYSQL_PATH (
+    set "MYSQL_EXE=%MYSQL_PATH%"
+)
+
+REM Detectar mysql.exe en el PATH del sistema si no se especifico
+if not defined MYSQL_EXE (
+    for /f "delims=" %%i in ('where mysql 2^>nul') do (
+        set "MYSQL_EXE=%%i"
+        goto :found_mysql
+    )
+)
+
+:found_mysql
+REM Fallback generico si no se encontro ninguna ruta
+if not defined MYSQL_EXE (
+    set "MYSQL_EXE=mysql"
+)
+
+where "%MYSQL_EXE%" >nul 2>&1
+if errorlevel 1 (
+    echo ERROR: No se encontro mysql.exe. Agregalo al PATH o define la variable MYSQL_PATH.
+    pause
+    exit /b 1
+)
+
+echo [1/3] Verificando MySQL en: %MYSQL_EXE%
+
+set "MYSQL_CMD=\"%MYSQL_EXE%\""
+
+%MYSQL_CMD% --version >nul 2>&1
+if errorlevel 1 (
+    echo ERROR: No se pudo ejecutar MySQL. Verifica tu instalacion.
     pause
     exit /b 1
 )
 
 echo [2/3] Conectando a la base de datos %DB_NAME%...
-"%MYSQL_BIN%\mysql.exe" -u root %DB_NAME% -e "SELECT 'Conexion exitosa' as status;" >nul 2>&1
+%MYSQL_CMD% -u root %DB_NAME% -e "SELECT 'Conexion exitosa' as status;" >nul 2>&1
 if errorlevel 1 (
     echo ERROR: No se pudo conectar a la base de datos %DB_NAME%
-    echo Asegurate de que la base de datos existe y Laragon esta corriendo
+    echo Asegurate de que la base de datos existe y MySQL esta corriendo
     pause
     exit /b 1
 )
 
 echo [3/3] Creando tablas de ordenes...
-"%MYSQL_BIN%\mysql.exe" -u root %DB_NAME% < install_orders.sql
+%MYSQL_CMD% -u root %DB_NAME% < install_orders.sql
 
 if errorlevel 1 (
     echo.
     echo ==========================================
     echo ERROR: Hubo un problema al crear las tablas
     echo ==========================================
 ) else (
     echo.
     echo ==========================================
     echo TABLAS CREADAS EXITOSAMENTE!
     echo ==========================================
     echo.
     echo Se crearon las siguientes tablas:
     echo  - ordenes
     echo  - orden_items
     echo.
     echo Ya puedes usar el sistema de carrito de compras!
 )
 
 echo.
 pause
diff --git a/REPARAR_TABLAS.bat b/REPARAR_TABLAS.bat
index dfd5b9f67d9fb9fadb60571a96041a27464ddcaf..6fdc155b888aa028f8dadc9acda88ca07236d2cd 100644
--- a/REPARAR_TABLAS.bat
+++ b/REPARAR_TABLAS.bat
@@ -1,39 +1,68 @@
 @echo off
+setlocal EnableDelayedExpansion
 cls
 echo ==========================================
 echo   REPARADOR DE TABLAS DE ORDENES
 echo   Base de datos: smartshop
 echo ==========================================
 echo.
 
-set MYSQL_BIN=C:\laragon\bin\mysql\mysql-8.0.30-winx64\bin
-set DB_NAME=smartshop
+set "DB_NAME=smartshop"
+set "MYSQL_EXE="
 
-echo [1/2] Conectando a la base de datos...
-"%MYSQL_BIN%\mysql.exe" -u root %DB_NAME% -e "SELECT 'Conexion exitosa' as status;" >nul 2>&1
+REM Permitir que el usuario defina MYSQL_PATH antes de ejecutar
+if defined MYSQL_PATH (
+    set "MYSQL_EXE=%MYSQL_PATH%"
+)
+
+REM Detectar mysql.exe en el PATH del sistema si no se especifico
+if not defined MYSQL_EXE (
+    for /f "delims=" %%i in ('where mysql 2^>nul') do (
+        set "MYSQL_EXE=%%i"
+        goto :found_mysql
+    )
+)
+
+:found_mysql
+REM Fallback generico si no se encontro ninguna ruta
+if not defined MYSQL_EXE (
+    set "MYSQL_EXE=mysql"
+)
+
+where "%MYSQL_EXE%" >nul 2>&1
+if errorlevel 1 (
+    echo ERROR: No se encontro mysql.exe. Agregalo al PATH o define la variable MYSQL_PATH.
+    pause
+    exit /b 1
+)
+
+echo [1/2] Conectando a la base de datos con: %MYSQL_EXE%
+set "MYSQL_CMD=\"%MYSQL_EXE%\""
+
+%MYSQL_CMD% -u root %DB_NAME% -e "SELECT 'Conexion exitosa' as status;" >nul 2>&1
 if errorlevel 1 (
     echo ERROR: No se pudo conectar a la base de datos %DB_NAME%
     pause
     exit /b 1
 )
 
 echo [2/2] Reparando tablas (DROP & CREATE)...
-"%MYSQL_BIN%\mysql.exe" -u root %DB_NAME% < fix_orders_table.sql
+%MYSQL_CMD% -u root %DB_NAME% < fix_orders_table.sql
 
 if errorlevel 1 (
     echo.
     echo ==========================================
     echo ERROR: Hubo un problema al reparar
     echo ==========================================
 ) else (
     echo.
     echo ==========================================
     echo TABLAS REPARADAS EXITOSAMENTE!
     echo ==========================================
     echo.
     echo Se corrigio la referencia a la tabla 'users'.
     echo Ya puedes intentar comprar de nuevo.
 )
 
 echo.
 pause
diff --git a/app/Controllers/ClientController.php b/app/Controllers/ClientController.php
index 8241984fd2b4b59f767603856f9daa274405fe74..6fb36a10740cf39c868a79dd18fff9dc034929ee 100644
--- a/app/Controllers/ClientController.php
+++ b/app/Controllers/ClientController.php
@@ -1,166 +1,166 @@
 <?php
 require_once __DIR__ . '/../Models/Product.php';
 require_once __DIR__ . '/../Models/Category.php';
 require_once __DIR__ . '/../Models/Cart.php';
 require_once __DIR__ . '/../Models/Order.php';
 require_once __DIR__ . '/../Config/Database.php';
+require_once __DIR__ . '/../helpers/url.php';
 
 class ClientController {
     
     /**
      * Muestra el cat√°logo de productos
      */
     public function index() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         $database = new Database();
         $db = $database->getConnection();
         
-        // Obtener productos
+        // Obtener productos (b√∫squeda opcional)
+        $searchQuery = trim($_GET['q'] ?? '');
         $productModel = new Product($db);
-        $stmt = $productModel->getAll();
+        $stmt = $searchQuery !== ''
+            ? $productModel->search($searchQuery)
+            : $productModel->getAll();
         $products = $stmt->fetchAll(PDO::FETCH_ASSOC);
         
         // Obtener categor√≠as para filtros
         $categoryModel = new Category($db);
         $stmtCat = $categoryModel->getAll();
         $categories = $stmtCat->fetchAll(PDO::FETCH_ASSOC);
         
         // Obtener contador del carrito
         $cartCount = Cart::getItemCount();
         
         require_once __DIR__ . '/../Views/client/index.php';
     }
     
     /**
      * A√±ade un producto al carrito
      */
     public function addToCart() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         if ($_SERVER['REQUEST_METHOD'] === 'POST') {
             $productId = $_POST['product_id'] ?? 0;
             $quantity = $_POST['quantity'] ?? 1;
             
             if ($productId > 0) {
                 $database = new Database();
                 $db = $database->getConnection();
                 
                 // Obtener datos del producto
                 $query = "SELECT id, nombre AS name, precio AS price, imagen_url AS image_url, stock 
                           FROM productos WHERE id = ? LIMIT 1";
                 $stmt = $db->prepare($query);
                 $stmt->bindParam(1, $productId);
                 $stmt->execute();
                 $product = $stmt->fetch(PDO::FETCH_ASSOC);
                 
                 if ($product && $product['stock'] >= $quantity) {
                     Cart::addItem($productId, $product, $quantity);
                     $_SESSION['success_message'] = '‚úÖ Producto a√±adido al carrito';
                 } else {
                     $_SESSION['error_message'] = '‚ùå Stock insuficiente';
                 }
             }
         }
-        
+
         // Redirigir de vuelta al cat√°logo
-        header('Location: /proyecto2/index.php?action=client');
-        exit;
+        redirect_to('index.php?action=client');
     }
     
     /**
      * Muestra el carrito de compras
      */
     public function viewCart() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         $cartItems = Cart::getItems();
         $cartTotal = Cart::getTotal();
         $cartCount = Cart::getItemCount();
         
         require_once __DIR__ . '/../Views/client/cart.php';
     }
     
     /**
      * Actualiza la cantidad de un producto en el carrito
      */
     public function updateCart() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         if ($_SERVER['REQUEST_METHOD'] === 'POST') {
             $productId = $_POST['product_id'] ?? 0;
             $quantity = $_POST['quantity'] ?? 0;
             
             if ($productId > 0) {
                 Cart::updateItem($productId, $quantity);
                 $_SESSION['success_message'] = 'Carrito actualizado';
             }
         }
         
-        header('Location: /proyecto2/public/index.php?action=cart');
-        exit;
+        redirect_to('index.php?action=cart');
     }
     
     /**
      * Elimina un producto del carrito
      */
     public function removeFromCart() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         $productId = $_GET['id'] ?? 0;
         
         if ($productId > 0) {
             Cart::removeItem($productId);
             $_SESSION['success_message'] = 'Producto eliminado del carrito';
         }
         
-        header('Location: /proyecto2/public/index.php?action=cart');
-        exit;
+        redirect_to('index.php?action=cart');
     }
     
     /**
      * Muestra la p√°gina de checkout
      */
     public function checkout() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         if (Cart::isEmpty()) {
-            header('Location: /proyecto2/public/index.php?action=cart');
-            exit;
+            redirect_to('index.php?action=cart');
         }
         
         $cartItems = Cart::getItems();
         $cartTotal = Cart::getTotal();
         $cartCount = Cart::getItemCount();
         
         require_once __DIR__ . '/../Views/client/checkout.php';
     }
     
     /**
      * Procesa la orden de compra
      */
     public function processOrder() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         if ($_SERVER['REQUEST_METHOD'] === 'POST' && !Cart::isEmpty()) {
             $database = new Database();
             $db = $database->getConnection();
             
             try {
                 // Iniciar transacci√≥n
                 $db->beginTransaction();
                 
@@ -169,68 +169,64 @@ class ClientController {
                 $orderModel->usuario_id = $_SESSION['user_id'] ?? null;
                 $orderModel->total = Cart::getTotal();
                 $orderModel->estado = 'pendiente';
                 $orderModel->nombre_cliente = $_POST['nombre'] ?? '';
                 $orderModel->email_cliente = $_POST['email'] ?? '';
                 $orderModel->telefono_cliente = $_POST['telefono'] ?? '';
                 $orderModel->direccion_envio = $_POST['direccion'] ?? '';
                 
                 $orderId = $orderModel->create();
                 
                 if ($orderId) {
                     // Crear items de la orden
                     $cartItems = Cart::getItems();
                     $orderModel->createOrderItems($orderId, $cartItems);
                     
                     // Actualizar stock
                     $orderModel->updateProductStock($cartItems);
                     
                     // Commit transacci√≥n
                     $db->commit();
                     
                     // Limpiar carrito
                     Cart::clear();
                     
                     // Redirigir a confirmaci√≥n
-                    header('Location: /proyecto2/index.php?action=order_confirmation&id=' . $orderId);
-                    exit;
+                    redirect_to('index.php?action=order_confirmation&id=' . $orderId);
                 } else {
                     throw new Exception('Error al crear la orden');
                 }
             } catch (Exception $e) {
                 $db->rollBack();
                 $_SESSION['error_message'] = 'Error al procesar la orden: ' . $e->getMessage();
-                header('Location: /proyecto2/index.php?action=checkout');
-                exit;
+                redirect_to('index.php?action=checkout');
             }
         } else {
-            header('Location: /proyecto2/index.php?action=cart');
-            exit;
+            redirect_to('index.php?action=cart');
         }
     }
     
     /**
      * Muestra la confirmaci√≥n de orden
      */
     public function orderConfirmation() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         $orderId = $_GET['id'] ?? 0;
         
         if ($orderId > 0) {
             $database = new Database();
             $db = $database->getConnection();
             $orderModel = new Order($db);
             
             $order = $orderModel->getById($orderId);
             $orderItems = $orderModel->getOrderItems($orderId);
             
             require_once __DIR__ . '/../Views/client/order_confirmation.php';
         } else {
-            header('Location: /proyecto2/public/index.php?action=client');
-            exit;
+            redirect_to('index.php?action=client');
         }
     }
 }
 ?>
diff --git a/app/Controllers/OrderController.php b/app/Controllers/OrderController.php
index b472d9d1f1b742c31ec430461d8951b376fe0020..7744015b1e0e8090b37ec0324a0096b253409958 100644
--- a/app/Controllers/OrderController.php
+++ b/app/Controllers/OrderController.php
@@ -1,43 +1,43 @@
 <?php
 require_once __DIR__ . '/../Models/Order.php';
 require_once __DIR__ . '/../Config/Database.php';
+require_once __DIR__ . '/../helpers/url.php';
 
 class OrderController {
     
     /**
      * Muestra todas las √≥rdenes para el administrador
      */
     public function index() {
         if (session_status() === PHP_SESSION_NONE) {
             session_start();
         }
         
         // Verificar que sea admin
         if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
-            header("Location: /proyecto2/index.php?action=client");
-            exit;
+            redirect_to('index.php?action=client');
         }
         
         $database = new Database();
         $db = $database->getConnection();
         
         // Obtener todas las √≥rdenes
         $query = "SELECT o.*, COUNT(oi.id) as items_count 
                   FROM ordenes o 
                   LEFT JOIN orden_items oi ON o.id = oi.orden_id 
                   GROUP BY o.id 
                   ORDER BY o.creado_en DESC";
         $stmt = $db->prepare($query);
         $stmt->execute();
         $orders = $stmt->fetchAll(PDO::FETCH_ASSOC);
         
         require_once __DIR__ . '/../Views/orders.php';
     }
     
     /**
      * API para obtener todas las √≥rdenes
      */
     public function apiGetAll() {
         header('Content-Type: application/json');
         
         $database = new Database();
diff --git a/app/Models/Product.php b/app/Models/Product.php
index 28ddbc0ee413aa8f09bcbacad5ef2f5e77c3ef04..940c66b4d65049739e698867afbc2bd8c20a516b 100644
--- a/app/Models/Product.php
+++ b/app/Models/Product.php
@@ -1,65 +1,92 @@
 <?php
 class Product {
     private $conn;
     private $table_name = "productos";
 
     public $id;
     public $nombre;
     public $descripcion;
     public $precio;
     public $stock;
     public $imagen_url;
     public $categoria_id;
     public $categoria_nombre;
 
     public function __construct($db) {
         $this->conn = $db;
     }
 
     public function getAll() {
-        $query = "SELECT p.id, 
-                         p.nombre, 
-                         p.nombre AS name, 
+        $query = "SELECT p.id,
+                         p.nombre,
+                         p.nombre AS name,
                          p.descripcion, 
                          p.descripcion AS description, 
                          p.precio, 
                          p.precio AS price, 
                          p.stock, 
                          p.imagen_url, 
                          p.imagen_url AS image_url, 
                          p.categoria_id, 
                          c.nombre AS categoria_nombre,
                          c.nombre AS category_name 
                   FROM " . $this->table_name . " p
                   LEFT JOIN categorias c ON p.categoria_id = c.id
                   ORDER BY p.id DESC";
         $stmt = $this->conn->prepare($query);
         $stmt->execute();
         return $stmt;
     }
 
+    public function search($term) {
+        $query = "SELECT p.id,
+                         p.nombre,
+                         p.nombre AS name,
+                         p.descripcion,
+                         p.descripcion AS description,
+                         p.precio,
+                         p.precio AS price,
+                         p.stock,
+                         p.imagen_url,
+                         p.imagen_url AS image_url,
+                         p.categoria_id,
+                         c.nombre AS categoria_nombre,
+                         c.nombre AS category_name
+                  FROM " . $this->table_name . " p
+                  LEFT JOIN categorias c ON p.categoria_id = c.id
+                  WHERE p.nombre LIKE :search OR p.descripcion LIKE :search
+                  ORDER BY p.id DESC";
+
+        $stmt = $this->conn->prepare($query);
+        $searchTerm = "%" . $term . "%";
+        $stmt->bindParam(':search', $searchTerm, PDO::PARAM_STR);
+        $stmt->execute();
+
+        return $stmt;
+    }
+
     public function create() {
         $query = "INSERT INTO " . $this->table_name . " SET
                     nombre=:nombre, descripcion=:descripcion, precio=:precio, stock=:stock, imagen_url=:imagen_url, categoria_id=:categoria_id";
 
         $stmt = $this->conn->prepare($query);
 
         $this->nombre = htmlspecialchars(strip_tags($this->nombre));
         $this->descripcion = htmlspecialchars(strip_tags($this->descripcion));
         $this->precio = htmlspecialchars(strip_tags($this->precio));
         $this->stock = htmlspecialchars(strip_tags($this->stock));
         $this->imagen_url = htmlspecialchars(strip_tags($this->imagen_url));
         $this->categoria_id = htmlspecialchars(strip_tags($this->categoria_id));
 
         $stmt->bindParam(":nombre", $this->nombre);
         $stmt->bindParam(":descripcion", $this->descripcion);
         $stmt->bindParam(":precio", $this->precio);
         $stmt->bindParam(":stock", $this->stock);
         $stmt->bindParam(":imagen_url", $this->imagen_url);
         $stmt->bindParam(":categoria_id", $this->categoria_id);
 
         if($stmt->execute()) {
             return true;
         }
         return false;
     }
diff --git a/app/Views/client/cart.php b/app/Views/client/cart.php
index ce15cd35a933b92044c93ea2f43b47f7bcf60809..42b30235533d064c87b1e9cdfcc93cbfaa2ea07c 100644
--- a/app/Views/client/cart.php
+++ b/app/Views/client/cart.php
@@ -208,140 +208,140 @@ require_once __DIR__ . '/header.php';
     background: #e8f5e9;
     padding: 15px;
     border-radius: 6px;
     margin-bottom: 20px;
     display: flex;
     align-items: center;
     gap: 10px;
 }
 
 .shipping-info i {
     color: #00a650;
     font-size: 1.5rem;
 }
 </style>
 
 <div class="cart-container">
     <?php if (empty($cartItems)): ?>
         <!-- Carrito Vac√≠o -->
         <div class="cart-card">
             <div class="empty-cart">
                 <div class="empty-cart-icon">
                     <i class="bi bi-cart-x"></i>
                 </div>
                 <h3>Tu carrito est√° vac√≠o</h3>
                 <p class="text-muted">¬°Agrega productos para comenzar tu compra!</p>
-                <a href="/proyecto2/index.php?action=client" class="btn btn-primary mt-3" style="background: #3483fa; border: none; padding: 12px 40px;">
+                <a href="<?php echo url_for('index.php?action=client'); ?>" class="btn btn-primary mt-3" style="background: #3483fa; border: none; padding: 12px 40px;">
                     <i class="bi bi-bag"></i> Ver Productos
                 </a>
             </div>
         </div>
     <?php else: ?>
         <div class="row">
             <!-- Items del Carrito -->
             <div class="col-lg-8">
                 <div class="cart-card">
                     <h2 class="cart-title">
                         <i class="bi bi-cart3"></i> Carrito de compras (<?php echo count($cartItems); ?> <?php echo count($cartItems) == 1 ? 'producto' : 'productos'; ?>)
                     </h2>
                     
                     <div class="shipping-info">
                         <i class="bi bi-truck"></i>
                         <div>
                             <strong>¬°Env√≠o gratis!</strong> en todos tus productos
                         </div>
                     </div>
                     
                     <?php foreach ($cartItems as $item): ?>
                     <div class="cart-item">
                         <!-- Imagen -->
                         <?php if (!empty($item['image_url'])): ?>
                             <img src="<?php echo htmlspecialchars($item['image_url']); ?>" 
                                  class="item-image" 
                                  alt="<?php echo htmlspecialchars($item['name']); ?>"
                                  onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                             <div class="item-image-placeholder" style="display: none;">
                                 <i class="bi bi-image"></i>
                             </div>
                         <?php else: ?>
                             <div class="item-image-placeholder">
                                 <i class="bi bi-image"></i>
                             </div>
                         <?php endif; ?>
                         
                         <!-- Detalles -->
                         <div class="item-details">
                             <div class="item-name"><?php echo htmlspecialchars($item['name']); ?></div>
                             <div class="item-price">Precio: $<?php echo number_format($item['price'], 2); ?></div>
                         </div>
                         
                         <!-- Cantidad -->
                         <div class="quantity-controls">
-                            <form method="POST" action="/proyecto2/index.php?action=update_cart" style="display: flex; gap: 10px; align-items: center;">
+                            <form method="POST" action="<?php echo url_for('index.php?action=update_cart'); ?>" style="display: flex; gap: 10px; align-items: center;">
                                 <input type="hidden" name="product_id" value="<?php echo $item['id']; ?>">
                                 <button type="submit" name="quantity" value="<?php echo $item['quantity'] - 1; ?>" class="quantity-btn">
                                     <i class="bi bi-dash"></i>
                                 </button>
                                 <input type="number" name="quantity_display" value="<?php echo $item['quantity']; ?>" 
                                        class="quantity-input" readonly>
                                 <button type="submit" name="quantity" value="<?php echo $item['quantity'] + 1; ?>" class="quantity-btn">
                                     <i class="bi bi-plus"></i>
                                 </button>
                             </form>
                         </div>
                         
                         <!-- Precio Total -->
                         <div class="item-total">
                             $<?php echo number_format($item['price'] * $item['quantity'], 2); ?>
                         </div>
                         
                         <!-- Eliminar -->
-                        <a href="/proyecto2/index.php?action=remove_from_cart&id=<?php echo $item['id']; ?>" 
+                        <a href="<?php echo url_for('index.php?action=remove_from_cart&id=' . $item['id']); ?>"
                            class="remove-btn"
                            onclick="return confirm('¬øEliminar este producto?');">
                             <i class="bi bi-trash"></i>
                         </a>
                     </div>
                     <?php endforeach; ?>
                     
                     <div class="mt-3">
-                        <a href="/proyecto2/index.php?action=client" class="continue-shopping">
+                        <a href="<?php echo url_for('index.php?action=client'); ?>" class="continue-shopping">
                             <i class="bi bi-arrow-left"></i> Seguir comprando
                         </a>
                     </div>
                 </div>
             </div>
             
             <!-- Resumen -->
             <div class="col-lg-4">
                 <div class="summary-card">
                     <h5 class="mb-3" style="font-weight: 700;">Resumen de compra</h5>
                     
                     <div class="summary-row">
                         <span>Productos (<?php echo count($cartItems); ?>)</span>
                         <span>$<?php echo number_format($cartTotal, 2); ?></span>
                     </div>
                     
                     <div class="summary-row" style="color: #00a650;">
                         <span><i class="bi bi-truck"></i> Env√≠o</span>
                         <span>Gratis</span>
                     </div>
                     
                     <div class="summary-total">
                         <span>Total</span>
                         <span>$<?php echo number_format($cartTotal, 2); ?></span>
                     </div>
                     
-                    <a href="/proyecto2/index.php?action=checkout" class="checkout-btn">
+                    <a href="<?php echo url_for('index.php?action=checkout'); ?>" class="checkout-btn">
                         <i class="bi bi-credit-card"></i> Continuar compra
                     </a>
                     
                     <div class="mt-3 text-center" style="font-size: 0.85rem; color: #666;">
                         <i class="bi bi-shield-check"></i> Compra 100% segura
                     </div>
                 </div>
             </div>
         </div>
     <?php endif; ?>
 </div>
 
 <?php require_once __DIR__ . '/footer.php'; ?>
diff --git a/app/Views/client/checkout.php b/app/Views/client/checkout.php
index 34d86a1d5b3f99d06567bedef4b0fc2893a55e42..88d1abed50dfcda5accf99af78e12157e54951d7 100644
--- a/app/Views/client/checkout.php
+++ b/app/Views/client/checkout.php
@@ -166,90 +166,90 @@ require_once __DIR__ . '/header.php';
     font-weight: 500;
 }
 
 .back-link:hover {
     text-decoration: underline;
 }
 
 .secure-badge {
     display: flex;
     align-items: center;
     gap: 8px;
     color: #00a650;
     font-size: 0.9rem;
     font-weight: 500;
     margin-bottom: 20px;
     background: #e8f5e9;
     padding: 10px;
     border-radius: 4px;
 }
 </style>
 
 <div class="checkout-container">
     <div class="row">
         <!-- Formulario -->
         <div class="col-lg-8">
-            <form method="POST" action="/proyecto2/index.php?action=process_order" id="checkoutForm">
+            <form method="POST" action="<?php echo url_for('index.php?action=process_order'); ?>" id="checkoutForm">
                 <div class="checkout-card">
                     <div class="section-title">
                         <i class="bi bi-person-circle"></i> Datos de Contacto
                     </div>
                     
                     <div class="row">
                         <div class="col-md-6 mb-3">
                             <label for="nombre" class="form-label">Nombre completo</label>
                             <input type="text" class="form-control" id="nombre" name="nombre" required placeholder="Tal cual figura en tu INE">
                         </div>
                         <div class="col-md-6 mb-3">
                             <label for="telefono" class="form-label">Tel√©fono celular</label>
                             <input type="tel" class="form-control" id="telefono" name="telefono" required placeholder="Para contactarte en la entrega">
                         </div>
                         <div class="col-12 mb-3">
                             <label for="email" class="form-label">Correo electr√≥nico</label>
                             <input type="email" class="form-control" id="email" name="email" required placeholder="Para enviarte el recibo de compra">
                         </div>
                     </div>
                 </div>
                 
                 <div class="checkout-card">
                     <div class="section-title">
                         <i class="bi bi-geo-alt-fill"></i> Direcci√≥n de Env√≠o
                     </div>
                     
                     <div class="mb-3">
                         <label for="direccion" class="form-label">Direcci√≥n completa</label>
                         <textarea class="form-control" id="direccion" name="direccion" rows="3" required placeholder="Calle, n√∫mero, colonia, c√≥digo postal, ciudad, referencias..."></textarea>
                     </div>
                 </div>
                 
                 <div class="d-none d-lg-block">
                     <button type="submit" class="confirm-btn">
                         <i class="bi bi-check-circle-fill"></i>
                         Confirmar Compra
                     </button>
                     <div class="text-center">
-                        <a href="/proyecto2/index.php?action=cart" class="back-link">
+                        <a href="<?php echo url_for('index.php?action=cart'); ?>" class="back-link">
                             <i class="bi bi-arrow-left"></i> Volver al carrito
                         </a>
                     </div>
                 </div>
             </form>
         </div>
         
         <!-- Resumen -->
         <div class="col-lg-4">
             <div class="summary-card">
                 <div class="section-title">Resumen de compra</div>
                 
                 <div class="secure-badge">
                     <i class="bi bi-shield-check"></i> Compra 100% protegida
                 </div>
                 
                 <div class="mb-4" style="max-height: 300px; overflow-y: auto;">
                     <?php foreach ($cartItems as $item): ?>
                     <div class="summary-item">
                         <?php if (!empty($item['image_url'])): ?>
                             <img src="<?php echo htmlspecialchars($item['image_url']); ?>" class="summary-img" alt="Producto">
                         <?php else: ?>
                             <div class="summary-img d-flex align-items-center justify-content-center bg-light text-muted">
                                 <i class="bi bi-image"></i>
                             </div>
diff --git a/app/Views/client/header.php b/app/Views/client/header.php
index 367f098458cb3e32f420a738f5d44b9980cada71..3f082bd41ae08aeee97fbc9f1654f617ac05a4d5 100644
--- a/app/Views/client/header.php
+++ b/app/Views/client/header.php
@@ -1,25 +1,26 @@
+<?php $searchQuery = $searchQuery ?? ''; ?>
 <!DOCTYPE html>
 <html lang="es">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title><?php echo $pageTitle ?? 'Tienda Online'; ?></title>
     
     <!-- Bootstrap CSS -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
     <!-- Bootstrap Icons -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
     
     <style>
         body {
             background: #f5f5f5;
             font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
         }
         
         /* Header Fijo */
         .header-top {
             background: #fff159;
             padding: 10px 0;
             box-shadow: 0 2px 5px rgba(0,0,0,0.1);
             position: sticky;
             top: 0;
@@ -141,66 +142,74 @@
             right: 20px;
             z-index: 1050;
             min-width: 300px;
             animation: slideIn 0.3s ease-out;
         }
         
         @keyframes slideIn {
             from {
                 transform: translateX(400px);
                 opacity: 0;
             }
             to {
                 transform: translateX(0);
                 opacity: 1;
             }
         }
     </style>
 </head>
 <body>
     
     <!-- Header estilo Mercado Libre -->
     <div class="header-top">
         <div class="container">
             <div class="row align-items-center">
                 <div class="col-md-2">
-                    <a href="/proyecto2/index.php?action=client" class="logo">
+                    <a href="<?php echo url_for('index.php?action=client'); ?>" class="logo">
                         <i class="bi bi-cart-fill"></i> MiTienda
                     </a>
                 </div>
                 <div class="col-md-8">
                     <div class="search-bar">
-                        <div class="input-group">
-                            <input type="text" class="form-control" placeholder="Buscar productos..." readonly onclick="window.location.href='/proyecto2/index.php?action=client'">
-                            <button class="btn btn-light" type="button">
+                        <form class="input-group" method="GET" action="<?php echo url_for('index.php'); ?>">
+                            <input type="hidden" name="action" value="client">
+                            <input
+                                type="text"
+                                class="form-control"
+                                name="q"
+                                placeholder="Buscar productos..."
+                                value="<?php echo htmlspecialchars($searchQuery ?? ''); ?>"
+                                aria-label="Buscar productos"
+                            >
+                            <button class="btn btn-light" type="submit" aria-label="Buscar">
                                 <i class="bi bi-search"></i>
                             </button>
-                        </div>
+                        </form>
                     </div>
                 </div>
                 <div class="col-md-2 text-end">
-                    <a href="/proyecto2/index.php?action=cart" class="cart-button">
+                    <a href="<?php echo url_for('index.php?action=cart'); ?>" class="cart-button">
                         <i class="bi bi-cart3"></i>
                         <?php 
                         if (session_status() === PHP_SESSION_NONE) session_start();
                         require_once __DIR__ . '/../../Models/Cart.php';
                         $cartCount = Cart::getItemCount();
                         if ($cartCount > 0): 
                         ?>
                         <span class="cart-badge"><?php echo $cartCount; ?></span>
                         <?php endif; ?>
                     </a>
                 </div>
             </div>
         </div>
     </div>
     
     <!-- Mensajes Flotantes -->
     <?php if (isset($_SESSION['success_message'])): ?>
     <div class="alert alert-success alert-dismissible fade show alert-floating" role="alert">
         <i class="bi bi-check-circle-fill"></i> <?php echo $_SESSION['success_message']; unset($_SESSION['success_message']); ?>
         <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
     </div>
     <?php endif; ?>
     
     <?php if (isset($_SESSION['error_message'])): ?>
     <div class="alert alert-danger alert-dismissible fade show alert-floating" role="alert">
diff --git a/app/Views/client/index.php b/app/Views/client/index.php
index e6f25020db8650ff175800e1ae54ed84dd922165..e51bbf11af5b73494068d1460c73fe3a48594f53 100644
--- a/app/Views/client/index.php
+++ b/app/Views/client/index.php
@@ -133,106 +133,120 @@ require_once __DIR__ . '/header.php';
     background: #ccc;
     cursor: not-allowed;
 }
 
 .stock-badge {
     display: inline-block;
     background: #e8f5e9;
     color: #2e7d32;
     padding: 4px 8px;
     border-radius: 4px;
     font-size: 0.75rem;
     font-weight: 600;
     margin-bottom: 8px;
 }
 
 .low-stock {
     background: #fff3cd;
     color: #856404;
 }
 </style>
 
 <!-- Contenido Principal -->
 <div class="container">
     <!-- Filtros -->
     <div class="filters-bar">
-        <strong>Categor√≠as:</strong>
-        <button class="filter-btn active" data-category="all">
-            <i class="bi bi-grid-fill"></i> Todas
-        </button>
-        <?php foreach ($categories as $category): ?>
-        <button class="filter-btn" data-category="<?php echo $category['id']; ?>">
-            <?php echo htmlspecialchars($category['nombre']); ?>
-        </button>
-        <?php endforeach; ?>
+        <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3">
+            <div>
+                <strong>Categor√≠as:</strong>
+                <button class="filter-btn active" data-category="all">
+                    <i class="bi bi-grid-fill"></i> Todas
+                </button>
+                <?php foreach ($categories as $category): ?>
+                <button class="filter-btn" data-category="<?php echo $category['id']; ?>">
+                    <?php echo htmlspecialchars($category['nombre']); ?>
+                </button>
+                <?php endforeach; ?>
+            </div>
+            <?php if (!empty($searchQuery)): ?>
+            <div class="text-muted small">
+                Mostrando resultados para "<?php echo htmlspecialchars($searchQuery); ?>" (<?php echo count($products); ?>)
+            </div>
+            <?php endif; ?>
+        </div>
     </div>
-        
+
         <!-- Grid de Productos -->
         <div class="products-grid">
+            <?php if (empty($products)): ?>
+                <div class="alert alert-warning w-100" role="alert">
+                    No se encontraron productos que coincidan con tu b√∫squeda.
+                </div>
+            <?php endif; ?>
             <?php foreach ($products as $product): ?>
             <div class="product-card" data-category="<?php echo $product['categoria_id']; ?>">
                 <!-- Imagen -->
                 <?php if (!empty($product['image_url'])): ?>
                     <img src="<?php echo htmlspecialchars($product['image_url']); ?>" 
                          class="product-image" 
                          alt="<?php echo htmlspecialchars($product['name']); ?>"
                          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                     <div class="product-image-placeholder" style="display: none;">
                         <i class="bi bi-image"></i>
                     </div>
                 <?php else: ?>
                     <div class="product-image-placeholder">
                         <i class="bi bi-image"></i>
                     </div>
                 <?php endif; ?>
                 
                 <!-- Informaci√≥n -->
                 <div class="product-body">
                     <div class="product-price">
                         $<?php echo number_format($product['price'], 2); ?>
                     </div>
                     
                     <div class="product-title">
                         <?php echo htmlspecialchars($product['name']); ?>
                     </div>
                     
                     <div class="product-shipping">
                         <i class="bi bi-truck"></i> Env√≠o gratis
                     </div>
                     
                     <div class="product-category">
                         <i class="bi bi-tag"></i> <?php echo htmlspecialchars($product['category_name'] ?? 'General'); ?>
                     </div>
                     
                     <?php if ($product['stock'] < 10 && $product['stock'] > 0): ?>
                     <span class="stock-badge low-stock">¬°√öltimas <?php echo $product['stock']; ?> unidades!</span>
                     <?php elseif ($product['stock'] > 0): ?>
                     <span class="stock-badge">Stock: <?php echo $product['stock']; ?> disponibles</span>
                     <?php endif; ?>
                     
                     <!-- Bot√≥n a√±adir -->
-                    <form method="POST" action="/proyecto2/index.php?action=add_to_cart">
+                    <form method="POST" action="<?php echo url_for('index.php?action=add_to_cart'); ?>">
                         <input type="hidden" name="product_id" value="<?php echo $product['id']; ?>">
                         <input type="hidden" name="quantity" value="1">
                         <button type="submit" class="add-to-cart-btn" <?php echo $product['stock'] <= 0 ? 'disabled' : ''; ?>>
                             <i class="bi bi-cart-plus"></i>
                             <?php echo $product['stock'] > 0 ? 'Agregar al carrito' : 'Sin stock'; ?>
                         </button>
                     </form>
                 </div>
             </div>
             <?php endforeach; ?>
         </div>
     </div>
     
     <script>
     // Filtro de categor√≠as
     document.querySelectorAll('.filter-btn').forEach(btn => {
         btn.addEventListener('click', function() {
             const category = this.dataset.category;
             
             // Actualizar botones activos
             document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
             this.classList.add('active');
             
             // Filtrar productos
             document.querySelectorAll('.product-card').forEach(card => {
diff --git a/app/Views/client/order_confirmation.php b/app/Views/client/order_confirmation.php
index f2a3bb2fcf32d95e015da7f8d308349e9da54f01..917f7b474327af815ca80679022f6bb38d1cb869 100644
--- a/app/Views/client/order_confirmation.php
+++ b/app/Views/client/order_confirmation.php
@@ -191,36 +191,36 @@ require_once __DIR__ . '/header.php';
             <div class="info-row">
                 <span class="info-label">Total Pagado</span>
                 <span class="info-value" style="font-size: 1.2rem; color: #3483fa;">$<?php echo number_format($order['total'], 2); ?></span>
             </div>
         </div>
         
         <div class="product-list">
             <h5 class="mb-3">Lo que compraste:</h5>
             <?php foreach ($orderItems as $item): ?>
             <div class="product-item">
                 <div class="product-icon">
                     <i class="bi bi-box-seam"></i>
                 </div>
                 <div class="product-info">
                     <div class="product-name"><?php echo htmlspecialchars($item['nombre_producto']); ?></div>
                     <div class="product-qty">Cantidad: <?php echo $item['cantidad']; ?></div>
                 </div>
                 <div class="product-price">
                     $<?php echo number_format($item['subtotal'], 2); ?>
                 </div>
             </div>
             <?php endforeach; ?>
         </div>
         
         <div class="actions mt-4">
-            <a href="/proyecto2/index.php?action=client" class="btn-primary-custom">
+            <a href="<?php echo url_for('index.php?action=client'); ?>" class="btn-primary-custom">
                 Seguir comprando
             </a>
             <button onclick="window.print()" class="btn-secondary-custom">
                 <i class="bi bi-printer"></i> Imprimir
             </button>
         </div>
     </div>
 </div>
 
 <?php require_once __DIR__ . '/footer.php'; ?>
diff --git a/app/Views/orders.php b/app/Views/orders.php
index c3144213735dd2c23b578a037b5e570e592b7188..4636ca463a454bba92a0be8fd73a44727087b327 100644
--- a/app/Views/orders.php
+++ b/app/Views/orders.php
@@ -485,104 +485,106 @@
         <div class="modal-content">
             <div class="modal-header">
                 <h5 class="modal-title"><i class="bi bi-arrow-repeat"></i> Cambiar Estado</h5>
                 <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
             </div>
             <div class="modal-body">
                 <input type="hidden" id="statusOrderId">
                 <label class="form-label fw-bold">Nuevo Estado:</label>
                 <select class="form-select form-select-lg" id="newStatus">
                     <option value="pendiente">‚è≥ Pendiente</option>
                     <option value="procesando">‚öôÔ∏è Procesando</option>
                     <option value="enviada">üöö Enviada</option>
                     <option value="completada">‚úÖ Completada</option>
                     <option value="cancelada">‚ùå Cancelada</option>
                 </select>
             </div>
             <div class="modal-footer">
                 <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                 <button type="button" class="btn btn-primary" onclick="updateOrderStatus()">Guardar Cambios</button>
             </div>
         </div>
     </div>
 </div>
 
 <script>
+const baseIndexUrl = '<?php echo url_for('index.php'); ?>';
+
 // Filtrar √≥rdenes
 function filterOrders(status) {
     const cards = document.querySelectorAll('.order-card');
     const pills = document.querySelectorAll('.filter-pill');
     
     pills.forEach(pill => pill.classList.remove('active'));
     event.target.closest('.filter-pill').classList.add('active');
     
     cards.forEach(card => {
         if (status === 'all' || card.dataset.status === status) {
             card.style.display = 'block';
         } else {
             card.style.display = 'none';
         }
     });
 }
 
 // Abrir modal de estado
 function openStatusModal(orderId, currentStatus) {
     document.getElementById('statusOrderId').value = orderId;
     document.getElementById('newStatus').value = currentStatus;
     new bootstrap.Modal(document.getElementById('statusModal')).show();
 }
 
 // Actualizar estado
 function updateOrderStatus() {
     const orderId = document.getElementById('statusOrderId').value;
     const newStatus = document.getElementById('newStatus').value;
     
-    fetch('/proyecto2/index.php?action=api_update_order_status', {
+    fetch(baseIndexUrl + '?action=api_update_order_status', {
         method: 'POST',
         headers: { 'Content-Type': 'application/json' },
         body: JSON.stringify({ id: orderId, status: newStatus })
     })
     .then(response => response.json())
     .then(data => {
         alert('‚úÖ ' + data.message);
         location.reload();
     })
     .catch(error => {
         alert('‚ùå Error al actualizar');
         console.error(error);
     });
 }
 
 // Ver detalles
 function viewOrderDetails(orderId) {
     const modal = new bootstrap.Modal(document.getElementById('orderDetailsModal'));
     const content = document.getElementById('orderDetailsContent');
     
     content.innerHTML = '<div class="text-center"><div class="spinner-border text-primary"></div></div>';
     modal.show();
     
-    fetch('/proyecto2/index.php?action=api_get_order&id=' + orderId)
+    fetch(baseIndexUrl + '?action=api_get_order&id=' + orderId)
         .then(response => response.json())
         .then(order => {
             let itemsHtml = '';
             order.items.forEach(item => {
                 itemsHtml += `
                     <tr>
                         <td>${item.nombre_producto}</td>
                         <td class="text-center">${item.cantidad}</td>
                         <td class="text-end">$${parseFloat(item.precio_unitario).toFixed(2)}</td>
                         <td class="text-end fw-bold">$${parseFloat(item.subtotal).toFixed(2)}</td>
                     </tr>
                 `;
             });
             
             content.innerHTML = `
                 <div class="row mb-3">
                     <div class="col-md-6">
                         <h6><i class="bi bi-person-circle"></i> Cliente</h6>
                         <p class="mb-1"><strong>Nombre:</strong> ${order.nombre_cliente}</p>
                         <p class="mb-1"><strong>Email:</strong> ${order.email_cliente}</p>
                         <p class="mb-1"><strong>Tel√©fono:</strong> ${order.telefono_cliente}</p>
                     </div>
                     <div class="col-md-6">
                         <h6><i class="bi bi-geo-alt-fill"></i> Env√≠o</h6>
                         <p>${order.direccion_envio}</p>
diff --git a/app/helpers/url.php b/app/helpers/url.php
new file mode 100644
index 0000000000000000000000000000000000000000..3298b80eca936945c5ac42ea1e417fff54a66316
--- /dev/null
+++ b/app/helpers/url.php
@@ -0,0 +1,26 @@
+<?php
+// URL helper functions for building paths relative to the app root
+
+if (!defined('BASE_PATH')) {
+    $scriptName = $_SERVER['SCRIPT_NAME'] ?? '';
+    $scriptDir = rtrim(str_replace('\\', '/', dirname($scriptName)), '/');
+    if ($scriptDir === '/' || $scriptDir === '.') {
+        $scriptDir = '';
+    }
+    define('BASE_PATH', $scriptDir);
+}
+
+if (!function_exists('url_for')) {
+    function url_for(string $path = ''): string {
+        $normalized = ltrim($path, '/');
+        $prefix = BASE_PATH === '' ? '/' : BASE_PATH . '/';
+        return $prefix . $normalized;
+    }
+}
+
+if (!function_exists('redirect_to')) {
+    function redirect_to(string $path = ''): void {
+        header('Location: ' . url_for($path));
+        exit;
+    }
+}
diff --git a/crear_tablas_ordenes.bat b/crear_tablas_ordenes.bat
index 99cbc97a9da0f8eb46c245250df9886e3687fa84..360628b1e57c270f43a72df3ab2c087a62800520 100644
--- a/crear_tablas_ordenes.bat
+++ b/crear_tablas_ordenes.bat
@@ -1,31 +1,56 @@
 @echo off
+setlocal EnableDelayedExpansion
 echo ========================================
 echo Creando Tablas de Ordenes en smartshop
 echo ========================================
 echo.
 
-REM Ruta de MySQL en Laragon
-set MYSQL_PATH=C:\laragon\bin\mysql\mysql-8.0.30-winx64\bin\mysql.exe
+set "DB_NAME=smartshop"
+set "MYSQL_EXE="
 
-echo Creando tabla ordenes...
-"%MYSQL_PATH%" -u root smartshop -e "CREATE TABLE IF NOT EXISTS ordenes (id INT AUTO_INCREMENT PRIMARY KEY, usuario_id INT NULL, total DECIMAL(10, 2) NOT NULL, estado VARCHAR(50) DEFAULT 'pendiente', nombre_cliente VARCHAR(255) NOT NULL, email_cliente VARCHAR(255), telefono_cliente VARCHAR(50), direccion_envio TEXT, creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (usuario_id) REFERENCES users(id) ON DELETE SET NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;"
+REM Permitir que el usuario defina MYSQL_PATH antes de ejecutar
+if defined MYSQL_PATH (
+    set "MYSQL_EXE=%MYSQL_PATH%"
+)
+
+REM Detectar mysql.exe en el PATH del sistema si no se especifico
+if not defined MYSQL_EXE (
+    for /f "delims=" %%i in ('where mysql 2^>nul') do (
+        set "MYSQL_EXE=%%i"
+        goto :found_mysql
+    )
+)
+
+:found_mysql
+REM Fallback generico si no se encontro ninguna ruta
+if not defined MYSQL_EXE (
+    set "MYSQL_EXE=mysql"
+)
+
+where "%MYSQL_EXE%" >nul 2>&1
+if errorlevel 1 (
+    echo ERROR: No se encontro mysql.exe. Agregalo al PATH o define la variable MYSQL_PATH.
+    pause
+    exit /b 1
+)
+
+echo Creando tabla ordenes con: %MYSQL_EXE%
+set "MYSQL_CMD=\"%MYSQL_EXE%\""
+
+%MYSQL_CMD% -u root %DB_NAME% -e "CREATE TABLE IF NOT EXISTS ordenes (id INT AUTO_INCREMENT PRIMARY KEY, usuario_id INT NULL, total DECIMAL(10, 2) NOT NULL, estado VARCHAR(50) DEFAULT 'pendiente', nombre_cliente VARCHAR(255) NOT NULL, email_cliente VARCHAR(255), telefono_cliente VARCHAR(50), direccion_envio TEXT, creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (usuario_id) REFERENCES users(id) ON DELETE SET NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;"
 
 echo Creando tabla orden_items...
-"%MYSQL_PATH%" -u root smartshop -e "CREATE TABLE IF NOT EXISTS orden_items (id INT AUTO_INCREMENT PRIMARY KEY, orden_id INT NOT NULL, producto_id INT NOT NULL, nombre_producto VARCHAR(255) NOT NULL, cantidad INT NOT NULL, precio_unitario DECIMAL(10, 2) NOT NULL, subtotal DECIMAL(10, 2) NOT NULL, creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (orden_id) REFERENCES ordenes(id) ON DELETE CASCADE, FOREIGN KEY (producto_id) REFERENCES productos(id) ON DELETE RESTRICT) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;"
+%MYSQL_CMD% -u root %DB_NAME% -e "CREATE TABLE IF NOT EXISTS orden_items (id INT AUTO_INCREMENT PRIMARY KEY, orden_id INT NOT NULL, producto_id INT NOT NULL, nombre_producto VARCHAR(255) NOT NULL, cantidad INT NOT NULL, precio_unitario DECIMAL(10, 2) NOT NULL, subtotal DECIMAL(10, 2) NOT NULL, creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (orden_id) REFERENCES ordenes(id) ON DELETE CASCADE, FOREIGN KEY (producto_id) REFERENCES productos(id) ON DELETE RESTRICT) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;"
 
 echo.
 echo Creando indices...
-"%MYSQL_PATH%" -u root smartshop -e "CREATE INDEX IF NOT EXISTS idx_ordenes_usuario ON ordenes(usuario_id);"
-"%MYSQL_PATH%" -u root smartshop -e "CREATE INDEX IF NOT EXISTS idx_ordenes_estado ON ordenes(estado);"
-"%MYSQL_PATH%" -u root smartshop -e "CREATE INDEX IF NOT EXISTS idx_orden_items_orden ON orden_items(orden_id);"
-"%MYSQL_PATH%" -u root smartshop -e "CREATE INDEX IF NOT EXISTS idx_orden_items_producto ON orden_items(producto_id);"
-
-echo.
-echo Verificando tablas...
-"%MYSQL_PATH%" -u root smartshop -e "SHOW TABLES;"
+%MYSQL_CMD% -u root %DB_NAME% -e "CREATE INDEX IF NOT EXISTS idx_ordenes_usuario ON ordenes(usuario_id);"
+%MYSQL_CMD% -u root %DB_NAME% -e "CREATE INDEX IF NOT EXISTS idx_ordenes_estado ON ordenes(estado);"
+%MYSQL_CMD% -u root %DB_NAME% -e "CREATE INDEX IF NOT EXISTS idx_orden_items_orden ON orden_items(orden_id);"
+%MYSQL_CMD% -u root %DB_NAME% -e "CREATE INDEX IF NOT EXISTS idx_orden_items_producto ON orden_items(producto_id);"
 
 echo.
 echo ========================================
 echo Tablas creadas exitosamente!
 echo ========================================
 pause
diff --git a/index.php b/index.php
index ff9faddc15e8fe8499f2b8236167e5948c4b578c..34e161b8ba34847eeab66e77aa64a518003de394 100644
--- a/index.php
+++ b/index.php
@@ -1,28 +1,29 @@
 <?php
 session_start();
 
+require_once __DIR__ . '/app/helpers/url.php';
 require_once 'app/Controllers/DashboardController.php';
 require_once 'app/Controllers/ProductController.php';
 require_once 'app/Controllers/AnalyticsController.php';
 require_once 'app/Controllers/AuthController.php';
 require_once 'app/Controllers/ClientController.php';
 require_once 'app/Controllers/OrderController.php';
 
 // Handle Client Actions (no auth required for shopping)
 if (isset($_GET['action'])) {
     $action = $_GET['action'];
     
     // Client routes that don't require authentication
     if (in_array($action, ['client', 'add_to_cart', 'cart', 'update_cart', 'remove_from_cart', 'checkout', 'process_order', 'order_confirmation'])) {
         $clientController = new ClientController();
         
         switch($action) {
             case 'client':
                 $clientController->index();
                 break;
             case 'add_to_cart':
                 $clientController->addToCart();
                 break;
             case 'cart':
                 $clientController->viewCart();
                 break;
diff --git a/run_database_updates.bat b/run_database_updates.bat
index 9133d94025193a7ee070e90a8f974e849ca5c958..0f80d1f4b9b5bb9a5ef01465a73dd32c03f422dc 100644
--- a/run_database_updates.bat
+++ b/run_database_updates.bat
@@ -1,34 +1,61 @@
 @echo off
+setlocal EnableDelayedExpansion
 echo ========================================
 echo Actualizando Base de Datos
 echo ========================================
 echo.
 
 REM Configuracion
-set DB_NAME=smartshop
-set DB_USER=root
-set DB_PASS=
+set "DB_NAME=smartshop"
+set "DB_USER=root"
+set "DB_PASS="
+set "MYSQL_EXE="
 
-REM Ruta de MySQL (ajustar segun instalacion de Laragon)
-set MYSQL_PATH=C:\laragon\bin\mysql\mysql-8.0.30-winx64\bin\mysql.exe
+REM Permitir que el usuario defina MYSQL_PATH antes de ejecutar
+if defined MYSQL_PATH (
+    set "MYSQL_EXE=%MYSQL_PATH%"
+)
+
+REM Detectar mysql.exe en el PATH del sistema si no se especifico
+if not defined MYSQL_EXE (
+    for /f "delims=" %%i in ('where mysql 2^>nul') do (
+        set "MYSQL_EXE=%%i"
+        goto :found_mysql
+    )
+)
+
+:found_mysql
+REM Fallback generico si no se encontro ninguna ruta
+if not defined MYSQL_EXE (
+    set "MYSQL_EXE=mysql"
+)
+
+where "%MYSQL_EXE%" >nul 2>&1
+if errorlevel 1 (
+    echo ERROR: No se encontro mysql.exe. Agregalo al PATH o define la variable MYSQL_PATH.
+    pause
+    exit /b 1
+)
+
+echo Ejecutando database_updates.sql con: %MYSQL_EXE%
+set "MYSQL_CMD=\"%MYSQL_EXE%\""
 
-echo Ejecutando database_updates.sql...
-"%MYSQL_PATH%" -u %DB_USER% -p%DB_PASS% %DB_NAME% < database_updates.sql
+%MYSQL_CMD% -u %DB_USER% -p%DB_PASS% %DB_NAME% < database_updates.sql
 
 if %ERRORLEVEL% EQU 0 (
     echo.
     echo ========================================
     echo Base de datos actualizada exitosamente!
     echo Se crearon las tablas:
     echo - ordenes
     echo - orden_items
     echo ========================================
 ) else (
     echo.
     echo ========================================
     echo ERROR: Hubo un problema al actualizar la base de datos
     echo ========================================
 )
 
 echo.
 pause
 
EOF
)